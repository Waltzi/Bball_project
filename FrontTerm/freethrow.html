<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="freethrow.css">
</head>
<body>
    <h2>Free Throw Tracker</h2>
    <div class="container">
        <table>
            <thead>
                <tr>
                    <th>Player Number</th>
                    <th>Free Throws Made</th>
                    <th>Free Throws Attempted</th>
                    <th>Free Throw Percentage</th>
                    <th>Practice Number</th>
                    <th>Date</th>
                </tr>
            </thead>
            <tbody id="freeThrowTableBody">
            </tbody>
        </table>
        <div class="button-container">
            <form id="player_form" onsubmit="handleSubmit(event)">
                <input type="number" id="playerNumber" name="playerNumber" required>
                <input type="number" id="freeThrowsMade" name="freeThrowsMade" required>
                <input type="number" id="freeThrowsAttempted" name="freeThrowsAttempted" required>
                <input type="number" id="freeThrowPercentage" name="freeThrowPercentage" required>
                <input type="number" id="practiceNumber" name="practiceNumber" required>
                <input type="text" id="date" name="date" required>
                <button type="submit" onclick="addItem()">Add Free Throw</button>
                <button id="back_button" onclick="location.href='index.html'">Back</button>
            </form>
        </div>
    </div>

    <script>
        // Function to add a free throw to the list
function addItem() {
    const playerNumber = document.getElementById('playerNumber').value;
    const freeThrowMade = document.getElementById('freeThrowsMade').value;
    const freeThrowAttempt = document.getElementById('freeThrowsAttempted').value;
    const item = {
        jerseyNumber: playerNumber,
        freeThrowsMade: freeThrowMade,
        freeThrowsAttempted: freeThrowAttempt
    };
    addFreeThrow(item);
}

// Function to display free throws
function displayItems() {
    const freeThrowTable = document.getElementById('freeThrowTableBody');
    freeThrows.forEach(freeThrow => {
        const row = document.createElement('tr');
        const playerNumberCell = document.createElement('td');
        playerNumberCell.textContent = freeThrow.jerseyNumber;
        row.appendChild(playerNumberCell);
        const freeThrowsMadeCell = document.createElement('td');
        freeThrowsMadeCell.textContent = freeThrow.freeThrowsMade;
        row.appendChild(freeThrowsMadeCell);
        const freeThrowsAttemptedCell = document.createElement('td');
        freeThrowsAttemptedCell.textContent = freeThrow.freeThrowsAttempted;
        row.appendChild(freeThrowsAttemptedCell);
        const freeThrowPercentageCell = document.createElement('td');
        freeThrowPercentageCell.textContent = freeThrow.freeThrowPercentage;
        row.appendChild(freeThrowPercentageCell);
        const practiceNumberCell = document.createElement('td');
        practiceNumberCell.textContent = freeThrow.practiceNumber;
        row.appendChild(practiceNumberCell);
        const dateCell = document.createElement('td');
        dateCell.textContent = freeThrow.date;
        row.appendChild(dateCell);
        freeThrowTable.appendChild(row);
    });
}

window.onload = fetchFreeThrows();

// Function to fetch free throws from the API
async function fetchFreeThrows() {
    try {
        const response = await fetch('http://localhost:8080/basketball_api/getFreeThrows');
        if (!response.ok) {
            throw new Error('Failed to fetch free throws');
        }
        freeThrows = await response.json();
        console.log('Free throws:', freeThrows);
        displayItems();
    } catch (error) {
        console.error('Error fetching free throws:', error);
    }

}

        // Funtion to add a freethrow to the API
async function addFreeThrow(freeThrow) {
  try {
      const response = await fetch('http://localhost:8080/basketball_api/addFreeThrow', {
          method: 'POST',
          headers: {
              'Content-Type': 'application/json'
          },  
          body: JSON.stringify(freeThrow)
      });
      if (!response.ok) {
          throw new Error('Failed to add free throw');
      }
      const addedFreeThrow = await response.json();
      console.log('Added free throw:', addedFreeThrow);
      return addedFreeThrow;
  } catch (error) {
      console.error('Error adding free throw:', error);
      throw error;
  }
}

// Function to edit a freethrow in the API
async function editFreeThrow(freeThrow) {
  try {
      const response = await fetch('http://localhost:8080/basketball_api/editFreeThrow', {
          method: 'PUT',
          headers: {
              'Content-Type': 'application/json'
          },
          body: JSON.stringify(freeThrow)
      });
      if (!response.ok) {
          throw new Error('Failed to edit free throw');
      }
      const editedFreeThrow = await response.json();
      console.log('Edited free throw:', editedFreeThrow);
      return editedFreeThrow;
  } catch (error) {
      console.error('Error editing free throw:', error);
      throw error;
  }
}
    async function handleSubmit(event){

    }

    </script>
    <script src="app.js"></script>
</body>
</html>